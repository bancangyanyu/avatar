{"version":3,"file":"index.js","sources":["pages/index/index.vue","../../../Program Files/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvaW5kZXgvaW5kZXgudnVl"],"sourcesContent":["<template>\r\n\t<view class=\"content\">\r\n<!-- \t\t<view class=\"search-input\">\r\n\t\t\t<fui-input borderTop placeholder=\"请输入名称\" class=\"input\"></fui-input>\r\n\t\t\t<fui-button radius=\"12rpx\" width='120rpx' height='60rpx' size='22'>查询</fui-button>\r\n\t\t</view> -->\r\n\t\t<view class=\"image-con\">\r\n\t\t\t<view class=\"tab-list\">\r\n\t\t\t\t<fui-tabs scroll :tabs=\"tabList\" v-model=\"tabActive\" @change=\"onTabSelect\" selectClass=\"text-yellow\" />\r\n\t\t\t</view>\r\n\t\t\t<n-list :list=\"imageList\" />\r\n\t\t</view>\r\n\t</view>\r\n</template>\r\n\r\n<script setup>\r\n\timport {\r\n\t\tonReachBottom,\r\n\t\tonPullDownRefresh\r\n\t } from '@dcloudio/uni-app'\r\n\timport {\r\n\t\tref,\r\n\t\tonMounted,\r\n\t\tshallowRef, \n\t\treactive\r\n\t} from 'vue';\r\n\tconst tabList = ref([])\r\n\tconst tabActive = ref(0)\r\n\tconst pageInfo = reactive({\r\n\t\tpageSize: 20,\r\n\t\tpageNum: 1\r\n\t})\r\n\tconst hasMore = ref(false)\r\n\tconst imageList = ref([]);\r\n\tonReachBottom(()=>{\r\n\t\tif (hasMore.value) {\r\n\t\t\tpageInfo.pageNum++\r\n\t\t\tgetImageData()\r\n\t\t} \r\n\t}) \r\n\tonPullDownRefresh(()=>{\r\n\t\tgetImageData(tabActive.value)\r\n\t})\r\n\tconst getTypeData = async ()=>{\r\n\t\t\r\n\t\tconst {\r\n\t\t\tresult: {\r\n\t\t\t\tdata\r\n\t\t\t},\r\n\t\t\tresult\r\n\t\t} = await uniCloud\r\n\t\t\t.callFunction({\r\n\t\t\t\tname: 'img-type-query',\r\n\t\t\t})\r\n\t\t\t.catch(err => {\r\n\t\t\t\tuni.hideLoading();\r\n\t\t\t\tconsole.error(err);\r\n\t\t\t})\r\n\t\t\tconsole.log(\"type\",data);\r\n\t\t\ttabList.value = data.map(item=>{\r\n\t\t\t\treturn{\r\n\t\t\t\t\tname: item.img_type,\r\n\t\t\t\t\tvalue:item.img_id\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t}\r\n\t\r\n\tconst getImageData = async (index=0) => {\r\n\t\t\r\n\t\tuni.showLoading({\r\n\t\t\ttitle: \"加载中...\"\r\n\t\t})\r\n\t\tconst {\r\n\t\t\tpageNum,\r\n\t\t\tpageSize\r\n\t\t} = pageInfo\r\n\t\tconst {\r\n\t\t\tresult: { \r\n\t\t\t\tdata\r\n\t\t\t},\r\n\t\t\tresult\r\n\t\t} = await uniCloud\r\n\t\t\t.callFunction({\r\n\t\t\t\tname: 'img-query',\r\n\t\t\t\tdata: {\r\n\t\t\t\t\tpageNum,\r\n\t\t\t\t\tpageSize,\r\n\t\t\t\t\timg_id: index || tabActive.value\r\n\t\t\t\t},\r\n\t\t\t}) \r\n\t\t\t.catch(err => {\r\n\t\t\t\tuni.hideLoading();\r\n\t\t\t\tuni.showModal({\r\n\t\t\t\t\tcontent: `查询失败，错误信息为：${err.message}`,\r\n\t\t\t\t\tshowCancel: false\r\n\t\t\t\t});\r\n\t\t\t\tconsole.error(err);\r\n\t\t\t\tuni.stopPullDownRefresh();\t\t \r\n\t\t\t})\r\n\t\tuni.stopPullDownRefresh();\r\n\t\thasMore.value = result?.hasMore //云端返回的是否有更多数据\r\n\t\timageList.value = imageList.value.concat(data) //云端返回的查询数据,追加到数组datalist\r\n\t\tconsole.log(\"shuju \",imageList.value);\r\n\t\tuni.hideLoading();\r\n\t}\r\n\tconst onTabSelect = ({value})=>{\r\n\t\tconsole.log(\"点击\",value);\r\n\t\timageList.value = []\r\n\t\tpageInfo.pageNum = 1\r\n\t\ttabActive.value = value\r\n\t\tgetImageData(value)\r\n\t}\r\n\tonMounted(() => {\r\n\t\tconsole.log('mounted');\r\n\t\tgetImageData()\r\n\t\tgetTypeData()\r\n\t});\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\t$border-radius: 24rpx;\r\n\r\n\t.content {\r\n\t\tdisplay: flex;\r\n\t\tflex-direction: column;\r\n\t\tjustify-content: center;\r\n\t\tposition: relative;\r\n\t\t.search-input {\r\n\t\t\theight: 100rpx;\r\n\t\t\tbox-sizing: border-box;\r\n\t\t\tpadding: 0 40rpx;\r\n\t\t\tdisplay: flex;\r\n\t\t\tjustify-content: space-between;\r\n\t\t\talign-items: center;\r\n\t\t\tbackground-color: #e9e9f0;\r\n\r\n\t\t\t::v-deep .fui-input__wrap {\r\n\t\t\t\tbackground: transparent !important;\r\n\t\t\t\tcolor: #000;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.image-con {\r\n\t\t\twidth: 100%;\r\n\t\t\tmargin-top: 100rpx;\r\n\t\t\tmin-height: calc(100vh - 100rpx);\r\n\t\t\toverflow-y: auto;\r\n\t\t\tbackground-color: #f2f2f8;\r\n\t\t\t.tab-list{\r\n\t\t\t\tposition: fixed;\r\n\t\t\t\tbackground-color: #fff;\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\ttop: 0;\r\n\t\t\t\tleft: 0;\r\n\t\t\t\tz-index: 2;\r\n\t\t\t}\r\n\t\t\t// padding: 30rpx;\r\n\t\t\t// box-sizing: border-box;\r\n\t\t}\r\n\t}\r\n</style>","import MiniProgramPage from 'D:/GIT_WORK/learn/avatar_vue3/pages/index/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","reactive","onReachBottom","onPullDownRefresh","uniCloud","uni","onMounted"],"mappings":";;;;;;;;;;;;;;;AA0BC,UAAM,UAAUA,cAAG,IAAC,EAAE;AACtB,UAAM,YAAYA,cAAG,IAAC,CAAC;AACvB,UAAM,WAAWC,cAAAA,SAAS;AAAA,MACzB,UAAU;AAAA,MACV,SAAS;AAAA,IACX,CAAE;AACD,UAAM,UAAUD,cAAG,IAAC,KAAK;AACzB,UAAM,YAAYA,kBAAI,CAAA,CAAE;AACxBE,kBAAAA,cAAc,MAAI;AACjB,UAAI,QAAQ,OAAO;AAClB,iBAAS;AACT,qBAAc;AAAA,MACd;AAAA,IACH,CAAE;AACDC,kBAAAA,kBAAkB,MAAI;AACrB,mBAAa,UAAU,KAAK;AAAA,IAC9B,CAAE;AACD,UAAM,cAAc,YAAU;AAE7B,YAAM;AAAA,QACL,QAAQ;AAAA,UACP;AAAA,QACA;AAAA,QACD;AAAA,MACA,IAAG,MAAMC,cAAQ,GAChB,aAAa;AAAA,QACb,MAAM;AAAA,MACV,CAAI,EACA,MAAM,SAAO;AACbC,sBAAG,MAAC,YAAW;AACfA,sBAAAA,MAAA,MAAA,SAAA,+BAAc,GAAG;AAAA,MACrB,CAAI;AACDA,oBAAA,MAAA,MAAA,OAAA,+BAAY,QAAO,IAAI;AACvB,cAAQ,QAAQ,KAAK,IAAI,UAAM;AAC9B,eAAM;AAAA,UACL,MAAM,KAAK;AAAA,UACX,OAAM,KAAK;AAAA,QACX;AAAA,MACL,CAAI;AAAA,IACF;AAED,UAAM,eAAe,OAAO,QAAM,MAAM;AAEvCA,oBAAAA,MAAI,YAAY;AAAA,QACf,OAAO;AAAA,MACV,CAAG;AACD,YAAM;AAAA,QACL;AAAA,QACA;AAAA,MACH,IAAM;AACJ,YAAM;AAAA,QACL,QAAQ;AAAA,UACP;AAAA,QACA;AAAA,QACD;AAAA,MACA,IAAG,MAAMD,cAAQ,GAChB,aAAa;AAAA,QACb,MAAM;AAAA,QACN,MAAM;AAAA,UACL;AAAA,UACA;AAAA,UACA,QAAQ,SAAS,UAAU;AAAA,QAC3B;AAAA,MACL,CAAI,EACA,MAAM,SAAO;AACbC,sBAAG,MAAC,YAAW;AACfA,sBAAAA,MAAI,UAAU;AAAA,UACb,SAAS,cAAc,IAAI,OAAO;AAAA,UAClC,YAAY;AAAA,QACjB,CAAK;AACDA,sBAAAA,MAAA,MAAA,SAAA,+BAAc,GAAG;AACjBA,sBAAG,MAAC,oBAAmB;AAAA,MAC3B,CAAI;AACFA,oBAAG,MAAC,oBAAmB;AACvB,cAAQ,QAAQ,iCAAQ;AACxB,gBAAU,QAAQ,UAAU,MAAM,OAAO,IAAI;AAC7CA,oBAAA,MAAA,MAAA,OAAA,gCAAY,UAAS,UAAU,KAAK;AACpCA,oBAAG,MAAC,YAAW;AAAA,IACf;AACD,UAAM,cAAc,CAAC,EAAC,MAAK,MAAI;AAC9BA,oBAAA,MAAA,MAAA,OAAA,gCAAY,MAAK,KAAK;AACtB,gBAAU,QAAQ,CAAE;AACpB,eAAS,UAAU;AACnB,gBAAU,QAAQ;AAClB,mBAAa,KAAK;AAAA,IAClB;AACDC,kBAAAA,UAAU,MAAM;AACfD,oBAAAA,MAAA,MAAA,OAAA,gCAAY,SAAS;AACrB,mBAAc;AACd,kBAAa;AAAA,IACf,CAAE;;;;;;;;;;;;;;;;;;;ACnHF,GAAG,WAAW,eAAe;"}