{"version":3,"file":"bgView.js","sources":["pages/bg/bgView.vue","../../../Program Files/HBuilderX/plugins/uniapp-cli-vite/uniPage:/cGFnZXMvYmcvYmdWaWV3LnZ1ZQ"],"sourcesContent":["<template>\n\t<view class=\"bg-content\">\r\n\t\t<image :src=\"bgUrl\" mode=\"scaleToFill\" class=\"bg\" ></image>\r\n\t\t<image src=\"/static/chat-bg.png\" mode=\"\" class=\"chat-bg\" v-if=\"showBg\"></image>\n\t\t<view class=\"action-btn-con\">\r\n\t\t\t<view class=\"action-btn\">\r\n\t\t\t\t<view class=\"item\" @click=\"handleAction(1)\">\r\n\t\t\t\t\t返回\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"item\" @click=\"handleAction(3)\" :class=\"{ active:showBg}\">\r\n\t\t\t\t\t切换背景\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"item\" @click=\"handleAction(2)\">\r\n\t\t\t\t\t下载 \r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</view>\n</template>\n\n<script setup>\r\n\timport {\r\n\t\tonLoad, \r\n\t\tonReachBottom\r\n\t } from '@dcloudio/uni-app'\r\n\timport {\r\n\t\tref,\r\n\t\tcomputed,\r\n\t\tonMounted,\r\n\t\tonUnmounted,\r\n\t} from 'vue';\n\tconst bgUrl = ref('')\r\n\tconst showBg = ref(true)\r\n\tconst handleAction = async(type=1)=>{\r\n\t\tif(type===1){\r\n\t\t\tuni.navigateBack()\r\n\t\t}else if(type===2){\r\n\t\t\tif(bgUrl.value){\r\n\t\t\t\tconst data = await getImageInfo(bgUrl.value)\r\n\t\t\t\thandleDownLoad(data)\r\n\t\t\t}\r\n\t\t}else{\r\n\t\t\tshowBg.value = !showBg.value\r\n\t\t}\r\n\t}\r\n\tconst getImageInfo = (imgUrl) => {\r\n\t\tuni.showLoading({\r\n\t\t\ttitle: \"加载中\"\r\n\t\t}) \r\n\t\treturn new Promise((reslove, reject) => {\r\n\t\t\tuni.getImageInfo({\r\n\t\t\t\tsrc: imgUrl,\r\n\t\t\t\tsuccess: (image) => {\r\n\t\t\t\t\tconsole.log(\"获取的图片信息\", image.path)\r\n\t\t\t\t\tuni.hideLoading()\r\n\t\t\t\t\treslove(image.path)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t})\r\n\t}\r\n\tconst handleDownLoad = (data) => {\r\n\t\tuni.hideLoading();\r\n\t\tuni.saveImageToPhotosAlbum({\r\n\t\t\tfilePath: data,\r\n\t\t\tsuccess: saveData => {\r\n\t\t\t\tuni.showModal({\r\n\t\t\t\t\ttitle: '保存成功',\r\n\t\t\t\t\tcontent: '聊天背景图已经在您的相册里啦',\r\n\t\t\t\t\tshowCancel: false\r\n\t\t\t\t})\r\n\t\t\t\tuni.vibrateShort({\r\n\t\t\t\t\tsuccess: () => {\r\n\t\t\t\t\t\tconsole.log('vibrateShort');\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tfail: error => {\r\n\t\t\t\tconsole.log(\"error\",error); \r\n\t\t\t\tif (error.errMsg.indexOf('fail')) {\r\n\t\t\t\t\tuni.showModal({\r\n\t\t\t\t\t\ttitle: '您需要授权相册权限',\r\n\t\t\t\t\t\tsuccess: res => {\r\n\t\t\t\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\t\t\t\tuni.openSetting({\r\n\t\t\t\t\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\t\t\t\t\tconsole.log('相册授权成功');\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\tfail(res) {\r\n\t\t\t\t\t\t\t\t\t\tconsole.log(res);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\tonLoad(options=>{\r\n\t\thandleOption(options); \r\n\t})\r\n\tconst handleOption = (option)=>{\r\n\t\tconst data = option?.item ? JSON.parse(option?.item) : {};\r\n\t\tconst {\r\n\t\t\timg_url,\r\n\t\t\timg_id\r\n\t\t} = data; \r\n\t\tbgUrl.value = img_url; \r\n\t}\n</script>\n\n<style scoped lang=\"scss\">\n.bg-content{\r\n\tposition: relative;\r\n\toverflow: hidden;\r\n\twidth: 100%;\r\n\t.chat-bg{\r\n\t\tposition: absolute;\r\n\t\ttop: 0;\r\n\t\tleft: 0; \r\n\t\tbottom: 0;\r\n\t\tright: 0;\r\n\t\twidth: 100%;\r\n\t\theight: 100%; \r\n\t\tz-index: 1;\r\n\t}\r\n\t// background-size:  100% 100%;\r\n\t.bg{\r\n\t\twidth: 100vw;\r\n\t\theight: 100vh;\r\n\t\tz-index: 0;\r\n\t}\r\n\t.action-btn-con{\r\n\t\tposition: absolute;\r\n\t\tbottom: 40rpx;\r\n\t\tleft: 0;\r\n\t\twidth: 100%;\r\n\t\tdisplay: flex;\r\n\t\tjustify-content: center;\r\n\t\tz-index: 1;\r\n\t\t.action-btn{\r\n\t\t\twidth: 90%;\r\n\t\t\tdisplay: flex;\r\n\t\t\tjustify-content: space-around;\r\n\t\t\talign-items: center;\r\n\t\t\t.item{\r\n\t\t\t\twidth: 200rpx;\r\n\t\t\t\theight: 70rpx;\r\n\t\t\t\ttext-align: center;\r\n\t\t\t\tcolor: #fff;\r\n\t\t\t\tborder-radius: 30rpx;\r\n\t\t\t\tbackground-color: #000;\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\talign-items: center; \r\n\t\t\t\tjustify-content: center;\r\n\t\t\t\t&.active{\r\n\t\t\t\t\tbackground-color: #ff5500;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\n</style>\n","import MiniProgramPage from 'D:/GIT_WORK/learn/avatar_vue3/pages/bg/bgView.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","uni","res","onLoad"],"mappings":";;;;;;AA+BC,UAAM,QAAQA,cAAG,IAAC,EAAE;AACpB,UAAM,SAASA,cAAG,IAAC,IAAI;AACvB,UAAM,eAAe,OAAM,OAAK,MAAI;AACnC,UAAG,SAAO,GAAE;AACXC,sBAAAA,MAAI,aAAc;AAAA,MACrB,WAAW,SAAO,GAAE;AACjB,YAAG,MAAM,OAAM;AACd,gBAAM,OAAO,MAAM,aAAa,MAAM,KAAK;AAC3C,yBAAe,IAAI;AAAA,QACnB;AAAA,MACJ,OAAO;AACJ,eAAO,QAAQ,CAAC,OAAO;AAAA,MACvB;AAAA,IACD;AACD,UAAM,eAAe,CAAC,WAAW;AAChCA,oBAAAA,MAAI,YAAY;AAAA,QACf,OAAO;AAAA,MACV,CAAG;AACD,aAAO,IAAI,QAAQ,CAAC,SAAS,WAAW;AACvCA,sBAAAA,MAAI,aAAa;AAAA,UAChB,KAAK;AAAA,UACL,SAAS,CAAC,UAAU;AACnBA,0BAAA,MAAA,MAAA,OAAA,6BAAY,WAAW,MAAM,IAAI;AACjCA,0BAAAA,MAAI,YAAa;AACjB,oBAAQ,MAAM,IAAI;AAAA,UAClB;AAAA,QACL,CAAI;AAAA,MACJ,CAAG;AAAA,IACD;AACD,UAAM,iBAAiB,CAAC,SAAS;AAChCA,oBAAG,MAAC,YAAW;AACfA,oBAAAA,MAAI,uBAAuB;AAAA,QAC1B,UAAU;AAAA,QACV,SAAS,cAAY;AACpBA,wBAAAA,MAAI,UAAU;AAAA,YACb,OAAO;AAAA,YACP,SAAS;AAAA,YACT,YAAY;AAAA,UACjB,CAAK;AACDA,wBAAAA,MAAI,aAAa;AAAA,YAChB,SAAS,MAAM;AACdA,4BAAAA,MAAY,MAAA,OAAA,6BAAA,cAAc;AAAA,YAC1B;AAAA,UACN,CAAK;AAAA,QACD;AAAA,QACD,MAAM,WAAS;AACdA,wBAAA,MAAA,MAAA,OAAA,6BAAY,SAAQ,KAAK;AACzB,cAAI,MAAM,OAAO,QAAQ,MAAM,GAAG;AACjCA,0BAAAA,MAAI,UAAU;AAAA,cACb,OAAO;AAAA,cACP,SAAS,SAAO;AACf,oBAAI,IAAI,SAAS;AAChBA,gCAAAA,MAAI,YAAY;AAAA,oBACf,QAAQC,MAAK;AACZD,oCAAAA,MAAA,MAAA,OAAA,6BAAY,QAAQ;AAAA,oBACpB;AAAA,oBACD,KAAKC,MAAK;AACTD,oCAAAA,gDAAYC,IAAG;AAAA,oBACf;AAAA,kBACV,CAAS;AAAA,gBACD;AAAA,cACD;AAAA,YACP,CAAM;AAAA,UACD;AAAA,QACD;AAAA,MACJ,CAAG;AAAA,IACD;AACDC,kBAAAA,OAAO,aAAS;AACf,mBAAa,OAAO;AAAA,IACtB,CAAE;AACD,UAAM,eAAe,CAAC,WAAS;AAC9B,YAAM,QAAO,iCAAQ,QAAO,KAAK,MAAM,iCAAQ,IAAI,IAAI;AACvD,YAAM;AAAA,QACL;AAAA,QACA;AAAA,MACA,IAAG;AACJ,YAAM,QAAQ;AAAA,IACd;;;;;;;;;;;;;;;;;AC3GF,GAAG,WAAW,eAAe;"}