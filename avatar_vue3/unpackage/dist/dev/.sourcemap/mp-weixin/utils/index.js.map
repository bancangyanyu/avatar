{"version":3,"file":"index.js","sources":["utils/index.js"],"sourcesContent":["export const setupAppUpdateListener = () => {\r\n\tlet updateManager = null\r\n\tif (wx.getUpdateManager) { \r\n\t\tupdateManager = wx.getUpdateManager()\r\n\t} else {\r\n\t\treturn\r\n\t}\r\n\r\n\tupdateManager.onCheckForUpdate(function(res) {\r\n\r\n\t}) \r\n\r\n\tupdateManager.onUpdateReady(function() {\r\n\t\twx.showModal({\r\n\t\t\ttitle: '更新提示',\r\n\t\t\tcontent: '新版本已经准备好，是否重启应用？',\r\n\t\t\tconfirmText: '重 启',\r\n\t\t\tshowCancel: false,\r\n\t\t\tsuccess: function(res) {\r\n\t\t\t\tif (res.confirm) {\r\n\t\t\t\t\t// 新的版本已经下载好，调用 applyUpdate 应用新版本并重启\r\n\t\t\t\t\tupdateManager.applyUpdate()\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t})\r\n\t})\r\n\r\n\tupdateManager.onUpdateFailed(function() {\r\n\t\t// 新的版本下载失败\r\n\t\tconsole.error(\"新的版本下载失败！\");\r\n\t})\r\n}\r\n\r\n// 设置缓存\nexport  function setCache(key, value, expireSeconds=86400) {\n  const currentTime = Date.now();\n  const expireTime = currentTime + expireSeconds * 1000; // 转换为毫秒\n  uni.setStorage({\n    key: key,\n    data: {\n      value: value,\n      expireTime: expireTime\n    },\n    success: function() {\n      console.log('缓存设置成功');\n    }\n  });\n}\n\n// 获取缓存\nexport function getCache(key) {\n  const res = uni.getStorageSync(key);\n  if (res && res.expireTime > Date.now()) {\n    return res.value;\n  } else {\n    uni.removeStorage({\n      key: key,\n      success: function() {\n        console.log('缓存已过期，已移除');\n      }\n    });\n    return null; // 缓存过期，返回null\n  }\n}\n"],"names":["wx","uni"],"mappings":";;AAAY,MAAC,yBAAyB,MAAM;AAC3C,MAAI,gBAAgB;AACpB,MAAIA,cAAAA,KAAG,kBAAkB;AACxB,oBAAgBA,cAAE,KAAC,iBAAkB;AAAA,EACvC,OAAQ;AACN;AAAA,EACA;AAED,gBAAc,iBAAiB,SAAS,KAAK;AAAA,EAE9C,CAAE;AAED,gBAAc,cAAc,WAAW;AACtCA,kBAAAA,KAAG,UAAU;AAAA,MACZ,OAAO;AAAA,MACP,SAAS;AAAA,MACT,aAAa;AAAA,MACb,YAAY;AAAA,MACZ,SAAS,SAAS,KAAK;AACtB,YAAI,IAAI,SAAS;AAEhB,wBAAc,YAAa;AAAA,QAC3B;AAAA,MACD;AAAA,IACJ,CAAG;AAAA,EACH,CAAE;AAED,gBAAc,eAAe,WAAW;AAEvCC,kBAAAA,MAAA,MAAA,SAAA,wBAAc,WAAW;AAAA,EAC3B,CAAE;AACF;AAGQ,SAAS,SAAS,KAAK,OAAO,gBAAc,OAAO;AACzD,QAAM,cAAc,KAAK;AACzB,QAAM,aAAa,cAAc,gBAAgB;AACjDA,gBAAAA,MAAI,WAAW;AAAA,IACb;AAAA,IACA,MAAM;AAAA,MACJ;AAAA,MACA;AAAA,IACD;AAAA,IACD,SAAS,WAAW;AAClBA,oBAAAA,MAAY,MAAA,OAAA,wBAAA,QAAQ;AAAA,IACrB;AAAA,EACL,CAAG;AACH;AAGO,SAAS,SAAS,KAAK;AAC5B,QAAM,MAAMA,cAAAA,MAAI,eAAe,GAAG;AAClC,MAAI,OAAO,IAAI,aAAa,KAAK,IAAG,GAAI;AACtC,WAAO,IAAI;AAAA,EACf,OAAS;AACLA,kBAAAA,MAAI,cAAc;AAAA,MAChB;AAAA,MACA,SAAS,WAAW;AAClBA,sBAAAA,2CAAY,WAAW;AAAA,MACxB;AAAA,IACP,CAAK;AACD,WAAO;AAAA,EACR;AACH;;;;"}